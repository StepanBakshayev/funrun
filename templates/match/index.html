{% extends "base.html" %}

{% block content %}
<h1>FUN RUN</h1>
<a href="{% url 'funrun.match.views.start_match' %}">Начать новый матч</a>
<h2>Матчи</h2>
{% include "inc/paginator.html" %}
<table class="matches">
	<tr>
		<th>Матч</th>
		<th>Дата</th>
		<th>Игроки</th>
		<th>Раунды</th>
		<th>Время</th>
		<th>Результат</th>
	</tr>
	{% for match in page.object_list %}
		<tr>
			<td><a href="{{ match.get_absolute_url }}">{{ match }}</a></td>
			<td>{{ match.end_time|date:"d E Y"|default:"Не завершён" }}</td>
			<td>{{ match.players.count }}</td>
			<td>{{ match.round_set.count }}</td>
			<td>{{ match.get_duration }}</td>
			<td>
				<ul>
					{% for leave in match.leave_set.all %}
						{% if leave.place > 0 %}
							<li class="place{{ leave.place }}">{{ leave.place }}: {{ leave.player }}</li>
						{% endif %}
					{% endfor %}
				</ul>
			</td>
		</tr>
	{% endfor %}
</table>
{% include "inc/paginator.html" %}
<h2>Игроки</h2>
<table class="players">
	<tr>
		<th>Игрок</th>
		<th>Матчей сыграно</th>
		<th>Раундов выиграно</th>
		<th>Золото</th>
		<th>Серебро</th>
		<th>Бронза</th>
	</tr>
	{% for player in players %}
		<tr>
			<td>{{ player }}</td>
			<td>{{ player.match_set.count }}</td>
			<td>{{ player.round_set.count }}</td>
			<td>{{ player.get_place1_number }}</td>
			<td>{{ player.get_place2_number }}</td>
			<td>{{ player.get_place3_number }}</td>
		</tr>
	{% endfor %}
</table>
{% endblock %}
